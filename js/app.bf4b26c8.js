(function(){"use strict";var t={4676:function(t,a,e){var r=e(3751),i=e(641);const n={id:"app"};function o(t,a,e,r,o,s){const c=(0,i.g2)("IndMap");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.bF)(c)])}var s=e(33);const c=t=>((0,i.Qi)("data-v-c4176dd4"),t=t(),(0,i.jt)(),t),d=c((()=>(0,i.Lk)("div",{id:"map-container"},[(0,i.Lk)("div",{id:"map"})],-1))),h={class:"container text-center"},l=c((()=>(0,i.Lk)("div",{class:"title"},"5 Day Weather Forecast",-1))),u={class:"text-list"},p={class:"weather-info"},m=["src"],f=c((()=>(0,i.Lk)("br",null,null,-1))),g=c((()=>(0,i.Lk)("div",{class:"graph-container"},null,-1)));function v(t,a,e,r,n,o){const c=(0,i.g2)("ToggleFloatButton");return(0,i.uX)(),(0,i.CE)(i.FK,null,[d,(0,i.bF)(c,{initialVisible:n.isFloatWindowVisible,"onUpdate:visible":o.updateVisibility},null,8,["initialVisible","onUpdate:visible"]),(0,i.Lk)("div",{class:(0,s.C4)(["left-float-window",{hidden:!n.isFloatWindowVisible}])},[(0,i.Lk)("div",h,[l,(0,i.Lk)("div",u,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(n.forecastGroupedByDate,((t,a)=>((0,i.uX)(),(0,i.CE)("div",{key:a,class:"date-group"},[(0,i.Lk)("div",p,(0,s.v_)(t),1),(0,i.Lk)("img",{src:o.getImageUrl(t.split(" : ")[2]),alt:"Weather Image",class:"weather-image"},null,8,m),f])))),128))])]),g],2)],64)}e(4114);var y=e(842),b=e.n(y),k=e(52);e(4809);function w(t,a){for(let e=0;e<t.length;e++){const r=t[e];if(r.coordinates[0]===a[0]&&r.coordinates[1]===a[1])return!0}return!1}function C(t,a,e,r,n,o){return(0,i.uX)(),(0,i.CE)("button",{onClick:a[0]||(a[0]=(...t)=>r.toggle&&r.toggle(...t))},(0,s.v_)(r.isVisible?"Hide":"Forecast Wether"),1)}var x=e(953),D={props:{initialVisible:{type:Boolean,default:!0}},setup(t,{emit:a}){const e=(0,x.KR)(t.initialVisible),r=()=>{e.value=!e.value,a("update:visible",e.value)};return{isVisible:e,toggle:r}}},E=e(6262);const _=(0,E.A)(D,[["render",C],["__scopeId","data-v-159f0324"]]);var T=_;const F={ref:"chart"};function U(t,a,e,r,n,o){return(0,i.uX)(),(0,i.CE)("div",F,null,512)}var L={name:"D3Chart",props:{chartType:{type:String,required:!0},dataUrl:{type:String,required:!0},xColumn:{type:String,required:!0},yColumn:{type:String,required:!0},width:{type:[String,Number],required:!0},height:{type:[String,Number],required:!0}},data(){return{chartData:null}},watch:{dataUrl:{immediate:!0,handler(t){this.loadData(t)}}},mounted(){this.createChart()},methods:{async loadData(t){try{const a=await fetch(t),e=await a.text(),r=k.swJ(e,(t=>({x:t[this.xColumn],y:+t[this.yColumn]}))).filter((t=>null!=t.x&&null!=t.y&&0!==t.y));this.chartData=r,this.createChart()}catch(a){console.error("Error loading data:",a)}},formatData(){this.chartData&&this.chartData.forEach((t=>{t.x=new Date(t.x).getFullYear()}))},createChart(){if(!this.chartData)return;const t={top:20,right:-50,bottom:40,left:20},a=this.width-t.left-t.right,e=this.height-t.top-t.bottom,r=k.Ltv(this.$refs.chart).append("svg").attr("width",a).attr("height",e).append("g").attr("transform",`translate(${t.left},${t.top})`);switch(this.chartType){case"line":this.createLineChart(r);break;case"bar":this.createBarChart(r);break}},createXAxis(t,a){const e={top:20,right:20,bottom:40,left:20},r=this.width-e.left-e.right,i=this.height-e.top-e.bottom,n=k.l78(a).tickSize(-i).tickPadding(10).tickFormat((t=>t.toString())),o=t.append("g").attr("class","x-axis").attr("transform",`translate(0,${i-e.bottom})`).call(n);o.append("text").attr("class","axis-label").attr("y",-e.bottom).attr("x",r/2).attr("text-anchor","middle").text(this.xColumn)},createYAxis(t,a){const e=k.V4s(a),r=t.append("g").call(e);r.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("y",-40).attr("x",-this.height/2).attr("text-anchor","middle").text(this.yColumn)},createLineChart(t){this.formatData();const a=k.m4Y().domain(k.Xxv(this.chartData,(t=>t.x))).range([0,this.width]),e=k.m4Y().domain([0,k.T9B(this.chartData,(t=>t.y))]).range([this.height,0]);t.append("g").call(k.V4s(e).ticks(6));const r=k.n8j().x((t=>a(t.x))).y((t=>e(t.y)));t.append("path").datum(this.chartData).attr("fill","#69b3a2").attr("fill-opacity",.3).attr("stroke","none").attr("d",k.Wcw().x((function(t){return a(t.x)})).y0(this.height).y1((function(t){return e(t.y)}))),t.append("path").datum(this.chartData).attr("fill","none").attr("stroke","steelblue").attr("stroke-width",1.5).attr("d",r).attr("stroke-dasharray",(function(){return this.getTotalLength()})).attr("stroke-dashoffset",(function(){return this.getTotalLength()})).transition().duration(2e3).attr("stroke-dashoffset",0),t.selectAll("myCircles").data(this.chartData).enter().append("circle").attr("fill","red").attr("stroke","none").attr("cx",(function(t){return a(t.x)})).attr("cy",(function(t){return e(t.y)})).attr("r",3),this.createXAxis(t,a,this.height),t.append("text").attr("text-anchor","start").attr("y",-10).attr("x",-20).text("Avg Temperature").style("fill","#008080")},createBarChart(t){this.formatData();const a=k.WH().domain(this.chartData.map((t=>t.x))).range([0,this.width]).padding(.2),e=k.m4Y().domain([0,k.T9B(this.chartData,(t=>t.y))]).range([this.height,0]);t.selectAll(".bar").data(this.chartData).enter().append("rect").attr("class","bar").attr("x",(t=>a(t.x))).attr("y",(t=>e(t.y))).attr("width",a.bandwidth()).attr("height",(t=>400-e(t.y))).attr("fill","orange"),this.createXAxis(t,a,this.height),this.createYAxis(t,e)}}};const A=(0,E.A)(L,[["render",U],["__scopeId","data-v-4da25bf1"]]);var M=A;let j={};var I={name:"IndMap",components:{ToggleFloatButton:T},data(){return{map:null,markers:[],addedMarkers:[],isFloatWindowVisible:!1,chartType:"line",dataUrl:"./data/uk_climate/UK000000000.csv",ColumnNameForX:"DATE",ColumnNameForY:"TAVG",chartWidth:800,chartHeight:300,openWeatherAPI:"51a4229e709d79b1b3f625724a2a8a25",forecastGroupedByDate:[]}},mounted(){this.initializeMap(),this.updateChartDimensions(),window.addEventListener("resize",this.updateChartDimensions)},beforeUnmount(){Object.keys(j).forEach((t=>{j[t]&&j[t].unmount()}))},methods:{updateVisibility(t){this.isFloatWindowVisible=t},initializeMap(){b().accessToken="pk.eyJ1IjoieDBsZW0iLCJhIjoiY2xyaHA2ejVkMDFsejJrcG43MDA3bjBsaiJ9.Q5hsTi_sqF2QKkZjsII_Ag",this.map=new(b().Map)({container:"map",style:"mapbox://styles/mapbox/dark-v10",center:[-1.83,52.42],zoom:6}),this.map.addControl(new(b().NavigationControl)),this.map.dragRotate.disable(),this.map.touchZoomRotate.disableRotation(),this.map.on("load",(()=>{this.setMap(this.map)}))},setMap(t){this.addBoundaryLayer(t),this.addPopupContent("./data/uk_climate/UK000000000.csv"),this.addPopupContent("./data/uk_climate/UK000003005.csv"),this.addPopupContent("./data/uk_climate/UK000003026.csv"),this.addPopupContent("./data/uk_climate/UK000003162.csv"),this.addPopupContent("./data/uk_climate/UK000003302.csv"),this.addPopupContent("./data/uk_climate/UK000003377.csv"),this.addPopupContent("./data/uk_climate/UKE/UKE00102158.csv"),this.addPopupContent("./data/uk_climate/UKE/UKE00105630.csv"),this.addPopupContent("./data/uk_climate/UKE/UKE00105636.csv"),this.addPopupContent("./data/uk_climate/UKE/UKE00105642.csv"),this.addPopupContent("./data/uk_climate/UKE/UKE00105861.csv")},addBoundaryLayer(t){fetch("./data/gadm41_GBR_2.json").then((t=>t.json())).then((a=>{t.addSource("gbp-data",{type:"geojson",data:a}),t.addLayer({id:"gbp-layer",type:"fill",source:"gbp-data",layout:{},paint:{"fill-color":"#E1FFFF","fill-opacity":.5}})})).catch((t=>console.log(t)))},addPopupContent(t){k.fu7(t).then((a=>{const e=a.map((t=>+t.TMAX)),r=a.map((t=>+t.EMNT)),i=k.T9B(e),n=k.jkA(r);this.markers=a.map((a=>{const e=`chart-${a.DATE}`;return{coordinates:[parseFloat(a.LONGITUDE),parseFloat(a.LATITUDE)],popupContent:`<div class="popup-content"><h3>History Max Temperature: ${i} <br/>\n              History Min Temperature: ${n}</h3><p>Avg temperature line chart</p><div id="${e}"></div></div>`,id:a.DATE,chartContainerId:e,dataUrl:t}})),this.addMarkers()}))},addMarkers(){this.markers.forEach((t=>{if(0==this.addedMarkers.length||!w(this.addedMarkers,t.coordinates)){const a=document.createElement("div");a.className="popup-content",a.innerHTML=t.popupContent,this.addedMarkers.push(t);const e=new(b().Popup)({maxWidth:"1920px"}).setDOMContent(a),r="./station.png",i=document.createElement("div"),n=document.createElement("img");n.src=r,n.style.width="25px",n.style.height="25px",i.appendChild(n),new(b().Marker)(i).setLngLat(t.coordinates).setPopup(e).addTo(this.map),e.on("open",(()=>{this.mountD3Chart(t.chartContainerId,t.dataUrl)})),i.addEventListener("click",(()=>{this.loadForecast(t.coordinates[1],t.coordinates[0])}))}}))},mountD3Chart(t,a){const e={chartType:this.chartType,dataUrl:a,xColumn:this.ColumnNameForX,yColumn:this.ColumnNameForY,width:this.chartWidth,height:this.chartHeight},i=document.getElementById(t);if(i){j[t]&&j[t].unmount();const a=(0,r.Ef)(M,e);j[t]=a,a.mount(i)}},updateChartDimensions(){this.chartWidth=window.innerWidth/2,this.chartHeight=window.innerHeight/4},convertTimestampToDate(t){const a=new Date(1e3*t);return a.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"})},groupForecastByDate(t){const a={};return t.forEach((t=>{const e=this.convertTimestampToDate(t.dt);a[e]||(a[e]=t)})),a},formatGroupedForecast(t){const a=[];return Object.keys(t).forEach((e=>{const r=t[e],i=r.main.feels_like.toFixed(2)+"Â°C",n=r.weather[0].description;a.push(`${e} : ${i} : ${n}`)})),a},loadForecast(t,a){const e=`https://api.openweathermap.org/data/2.5/forecast?lat=${t}&lon=${a}&appid=${this.openWeatherAPI}&units=metric`;fetch(e).then((t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()})).then((t=>{const a=this.groupForecastByDate(t.list);this.forecastGroupedByDate=this.formatGroupedForecast(a)})).catch((t=>{console.error("Failed to fetch weather data:",t)}))},getImageUrl(t){const a={"scattered ":"./weather_icons/sun_rain.png","light rain":"./weather_icons/rain.png","overcast clouds":"./weather_icons/going_rain.png","clear sky":"./weather_icons/sun.png","few clouds":"./weather_icons/few_clouds.png"};return a[t]||"./weather_icons/going_rain.png"}}};const K=(0,E.A)(I,[["render",v],["__scopeId","data-v-c4176dd4"]]);var B=K,P={name:"App",components:{IndMap:B}};const W=(0,E.A)(P,[["render",o]]);var V=W;(0,r.Ef)(V).mount("#app")}},a={};function e(r){var i=a[r];if(void 0!==i)return i.exports;var n=a[r]={exports:{}};return t[r].call(n.exports,n,n.exports,e),n.exports}e.m=t,function(){var t=[];e.O=function(a,r,i,n){if(!r){var o=1/0;for(h=0;h<t.length;h++){r=t[h][0],i=t[h][1],n=t[h][2];for(var s=!0,c=0;c<r.length;c++)(!1&n||o>=n)&&Object.keys(e.O).every((function(t){return e.O[t](r[c])}))?r.splice(c--,1):(s=!1,n<o&&(o=n));if(s){t.splice(h--,1);var d=i();void 0!==d&&(a=d)}}return a}n=n||0;for(var h=t.length;h>0&&t[h-1][2]>n;h--)t[h]=t[h-1];t[h]=[r,i,n]}}(),function(){e.n=function(t){var a=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(a,{a:a}),a}}(),function(){e.d=function(t,a){for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)}}(),function(){var t={524:0};e.O.j=function(a){return 0===t[a]};var a=function(a,r){var i,n,o=r[0],s=r[1],c=r[2],d=0;if(o.some((function(a){return 0!==t[a]}))){for(i in s)e.o(s,i)&&(e.m[i]=s[i]);if(c)var h=c(e)}for(a&&a(r);d<o.length;d++)n=o[d],e.o(t,n)&&t[n]&&t[n][0](),t[n]=0;return e.O(h)},r=self["webpackChunktemeperature_view"]=self["webpackChunktemeperature_view"]||[];r.forEach(a.bind(null,0)),r.push=a.bind(null,r.push.bind(r))}();var r=e.O(void 0,[504],(function(){return e(4676)}));r=e.O(r)})();
//# sourceMappingURL=app.bf4b26c8.js.map